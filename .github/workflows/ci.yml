name: CI

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  lint:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Check shell scripts
      run: |
        sudo apt-get install -y shellcheck
        shellcheck install.sh check_env.sh
      continue-on-error: true
    
    - name: Check Python scripts
      run: |
        pip install pylint
        pylint examples/ncu_analyzer.py || true
      continue-on-error: true

  test-install:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Test installation
      run: |
        chmod +x install.sh
        ./install.sh --check || true
    
    - name: Test user install
      run: |
        ./install.sh --user --target /tmp/test-install
        ls -la /tmp/test-install/
        test -f /tmp/test-install/SKILL.md
        test -f /tmp/test-install/bin/ncu-profile
